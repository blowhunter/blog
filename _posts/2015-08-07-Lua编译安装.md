---
layout: post
title: 在win8.1下使用minGW编译器编译Lua-5.3.1
category : Lua
tagline: "Lua"
tags : lua
published: true
---
{% include JB/setup %}
### 在win8.1下使用minGW编译器编译Lua-5.3.1
---
- 首先准备好Lua的源码：
下载地址：（官网）[地址链接](http://www.lua.org/download.html)
- 准备好minGW编译器，这里用的是codeblocks的minGW编译器。
下载地址：[地址链接](http://www.codeblocks.org/downloads/26#windows)
- 安装完毕后，需要在系统环境变量中进行编译器路径的设置，如图：
  ![系统环境变量设置](https://raw.githubusercontent.com/blowhunter/blog/gh-pages/_posts/images/2005/08/systemEnvironmentPath.jpg)
- 然后键入以下路径，请按照安装路径自行修改
	<pre class="prettyprint linenums">
	E:\Program Files (x86)\CodeBlocks\MinGW\bin		#即为mingw32-make.exe所在目录</pre>
- 将下载好的源码Lua-5.3.1.tar.gz解压到C:\目录下，然后win+R键入cmd进入命令行：
	<pre class="prettyprint linenums">
	cd C:\lua-5.3.1\src\</pre>
- 执行编译命令即可。
	<pre class="prettyprint linenums">
	mingw32-make mingw</pre>

- **进阶：**
对Makefile进行修改，以实现特别的编译需求，比如将lua-5.3.1\src\Makefile文件里面mingw项下的编译选项进行修改：
	<pre class="prettyprint linenums">
	mingw:
	$(MAKE) "LUA_A=lua53.dll" "LUA_T=lua.exe" \
	"AR=$(AR) -o" "RANLIB=strip --strip-unneeded" \
	"SYSCFLAGS=-static" "SYSLIBS=" "SYSLDFLAGS=-s" lua.exe		
	$(MAKE) "LUAC_T=luac.exe" luac.exe
	# 修改"SYSCFLAGS=-DLUA_BUILD_AS_DLL" --> "SYSCFLAGS=-static"
	# "AR=$(CC) -shared -o" --> "AR=$(AR) -o"
	# "LUA_A=lua53.dll" --> "LUA_A=lua53.a"</pre>
- 然后执行编译命令：
	<pre class="prettyprint linenums">
	mingw32-make mingw</pre>
	
**--本文结束--**
	
